<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Nunito+Sans:ital,opsz,wght@0,6..12,200..1000;1,6..12,200..1000&display=swap"
      rel="stylesheet"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Mr+De+Haviland&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
    />
    <title>Tri-inspire</title>
    <link rel="stylesheet" href="assets/css/style.css" />

    <style>
      input {
        margin-bottom: 0;
      }
    </style>
  </head>
  <body>
    <div class="enrol">
      <div class="row g-4">
        <div class="col-md-6">
          <div class="enrol-img p-5">
            <img src="./assets/img/Rectangle348.png" alt="" />
          </div>
        </div>

        <div class="col-md-6">
          <div class="form-sec">
            <h5 class="text-center">
              You are a step closer to <br />
              achieving your goal
            </h5>
            <div class="form-con">
              <form id="courseForm">
                <div>
                  <label for="firstname" class="form-label"
                    >Firstname <span class="text-danger">*</span></label
                  >
                  <input
                    type="text"
                    name="firstname"
                    class="form-control"
                    placeholder="Enter Firstname"
                  />
                  <small class="text-danger" id="firstnameError"></small>
                </div>
                <div>
                  <label for="lastname" class="form-label"
                    >Lastname <span class="text-danger">*</span></label
                  >
                  <input
                    type="text"
                    name="lastname"
                    class="form-control"
                    placeholder="Enter Lastname"
                  />
                  <small class="text-danger" id="lastnameError"></small>
                </div>
                <div>
                  <label for="exampleInputEmail1" class="form-label"
                    >Email Address <span class="text-danger">*</span></label
                  >
                  <input
                    type="email"
                    class="form-control"
                    name="email"
                    placeholder="Enter email address"
                  />
                  <small class="text-danger" id="emailError"></small>
                </div>
                <div>
                  <label for="phone" class="form-label"
                    >Phone Number <span class="text-danger">*</span></label
                  >
                  <input
                    type="text"
                    name="phone"
                    class="form-control"
                    placeholder="e.g 08123456789"
                  />
                  <small class="text-danger" id="phoneError"></small>
                </div>
                <div>
                  <label for="exampleInputEmail1" class="form-label"
                    >Which course do you want to apply for
                    <span class="text-danger">*</span></label
                  >
                  <select
                    class="form-select"
                    name="course"
                    id="courseType"
                    required
                  >
                    <option value="" disabled selected>Select course</option>
                    <option value="data_analysis">Data analysis</option>
                    <option value="mobile_app_development">
                      Mobile App Development
                    </option>
                    <option value="sales_and_marketing">
                      Sales and Marketing
                    </option>
                  </select>
                  <small class="text-danger" id="courseTypeError"></small>
                </div>
                <div>
                  <label for="amount" class="form-label"
                    >Amount <span class="text-danger">*</span></label
                  >
                  <input
                    type="text"
                    name="amount"
                    id="amountInput"
                    class="form-control"
                    readonly
                  />
                  <small class="text-danger" id="amountError"></small>
                </div>
                <div>
                  <label for="exampleInputEmail1" class="form-label"
                    >Which class do you prefer
                    <span class="text-danger">*</span></label
                  >
                  <select class="form-select" name="class_type" required>
                    <option value="" disabled selected>Select class</option>
                    <option value="physical">Physical</option>
                    <option value="virtual">Virtual</option>
                  </select>
                  <small class="text-danger" id="classTypeError"></small>
                </div>

                <div>
                  <label for="exampleInputEmail1" class="form-label"
                    >Payment Type <span class="text-danger">*</span></label
                  >

                  <select
                    class="form-select"
                    name="payment_type"
                    id="paymentType"
                    required
                  >
                    <option value="" disabled selected>
                      Select payment type
                    </option>
                    <option value="transfer">Transfer</option>
                    <option value="student_loan">Student Loan</option>
                  </select>

                  <small class="text-danger" id="paymentTypeError"></small>
                </div>

                <div id="transfer-info" style="display: none">
                  <div>
                    <p class="m-0">Kindly make payment into this account</p>
                    <p class="m-0 fw-bold">
                      Account Number: 12345678901 <br />
                      Account name: Tri Inspire Tech Ltd <br />
                      Bank: GTBank
                    </p>
                  </div>

                  <div class="mt-2">
                    <label for="receipt" class="form-label"
                      >Upload Payment Receipt
                      <span class="text-danger">*</span></label
                    >
                    <input type="file" class="form-control" name="receipt" />
                    <small class="text-danger" id="receiptError"></small>
                  </div>
                </div>
                <div class="d-flex justify-content-center">
                  <button type="button" class="sub-btn btn-secondary">
                    Submit
                  </button>
                </div>
              </form>

              <!-- Modal -->
              <div
                class="modal fade"
                id="exampleModal"
                tabindex="-1"
                aria-labelledby="exampleModalLabel"
                aria-hidden="true"
              >
                <div class="modal-dialog modal-dialog-centered">
                  <div class="modal-content">
                    <div class="modal-header">
                      <button
                        type="button"
                        class="btn-close"
                        data-bs-dismiss="modal"
                        aria-label="Close"
                      ></button>
                    </div>
                    <div class="modal-body">
                      <div>
                        <img src="./assets/img/Frame1.png" alt="" />
                      </div>

                      <h6>Thank you for your submission!</h6>

                      <p>
                        Expect a call from one of our team members <br />within
                        the next 24 hours.
                      </p>
                    </div>
                    <div class="modal-footer">
                      <a href="./enrol.html">
                        <button type="button" class="modal-btn btn-primary">
                          Back to home page
                        </button>
                      </a>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <section class="footer p-x-all">
      <div class="container-fluid px-0 pt-5">
        <div class="row">
          <div class="col-md-5 footer-col">
            <div class="footer-con1">
              <div class="footer-img">
                <img src="assets/img/TRII 1.png" class="w-100" />
              </div>
              <div class="footer-text1">
                <p>
                  Empowering individuals and businesses to achieve sustainable
                  goals through innovative technologies. TriInspire aim at
                  connecting you with top talents needed to scale your business.
                  <br />
                  <br />
                  Building dream project teams, one connection at a time
                </p>
              </div>
            </div>
          </div>
          <div class="col-md-3">
            <div class="footer-con">
              <div class="s-h6">
                <h6>Services</h6>
              </div>
              <div class="footer-nav">
                <ul>
                  <li class="footer-item">
                    <a href="./Data.html">Data Analytics</a>
                  </li>
                  <li class="footer-item">
                    <a href="./skill.html">Soft Skills</a>
                  </li>
                  <li class="footer-item">
                    <a href="#">Get hired</a>
                  </li>
                  <li class="footer-item">
                    <a href="./hire.html">Hire a Talent</a>
                  </li>
                  <li class="footer-item">
                    <a href="./workplace.html">Workplace Clinic</a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <div class="col-md-4 footer-col3">
            <div class="footer-con">
              <div class="contact-h6">
                <h6>Contact us</h6>
              </div>
              <div class="contact-p">
                <p>
                  1 Olusesi Osanyi Street, <br />
                  AIT Road, Kola, Lagos.
                  <br />
                  <br />
                  <a href="email">triinspiretechltd@gmail.com</a>
                </p>
                <div class="number">
                  +2348155752880, +2348146089572, <br />
                  +2348056536066.
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="bottom-footer">
          <div class="arr-img">
            <img src="assets/img/ARR 1.png" alt="" />
          </div>
          <div class="arr-text">
            <p>Triinspire 2024. All rights reserved.</p>
          </div>
        </div>
      </div>
    </section>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>

    <script>
      const courseSelect = document.getElementById("courseType");
      const amountInput = document.getElementById("amountInput");

      const coursePrices = {
        data_analysis: 50000,
        mobile_app_development: 70000,
        sales_and_marketing: 60000,
      };

      courseSelect.addEventListener("change", function () {
        const selectedCourse = this.value;

        if (coursePrices[selectedCourse]) {
          amountInput.value = coursePrices[selectedCourse];
        } else {
          amountInput.value = "";
        }
      });

      const paymentDropdown = document.getElementById("paymentType");
      const transferInfo = document.getElementById("transfer-info");

      paymentDropdown.addEventListener("change", () => {
        if (paymentDropdown.value === "transfer") {
          transferInfo.style.display = "block";
        } else {
          transferInfo.style.display = "none";
        }
      });

      document
        .querySelector(".sub-btn")
        .addEventListener("click", async function () {
          let isValid = true;

          function showError(field, message) {
            document.getElementById(field + "Error").textContent = message;
            isValid = false;
          }

          function clearError(field) {
            document.getElementById(field + "Error").textContent = "";
          }

          const form = document.getElementById("courseForm");

          const firstname = document
            .querySelector('[name="firstname"]')
            .value.trim();
          const lastname = document
            .querySelector('[name="lastname"]')
            .value.trim();
          const email = document.querySelector('[name="email"]').value.trim();
          const phone = document.querySelector('[name="phone"]').value.trim();
          const course = document.querySelector('[name="course"]').value;
          const amount = document.getElementById("amountInput").value;
          const classType = document.querySelector('[name="class_type"]').value;
          const paymentType = document.querySelector(
            '[name="payment_type"]'
          ).value;
          const receipt = document.querySelector('[name="receipt"]').files[0];

          if (firstname === "") showError("firstname", "Firstname is required");
          else clearError("firstname");

          if (lastname === "") showError("lastname", "Lastname is required");
          else clearError("lastname");

          if (email === "") showError("email", "Email is required");
          else if (!/^\S+@\S+\.\S+$/.test(email))
            showError("email", "Invalid email format");
          else clearError("email");

          if (phone === "") showError("phone", "Phone number is required");
          else if (!/^\d{11}$/.test(phone))
            showError("phone", "Phone number must be 11 digits");
          else clearError("phone");

          if (!course) showError("courseType", "Please select a course");
          else clearError("courseType");

          if (!classType) showError("classType", "Please select class type");
          else clearError("classType");

          if (!paymentType)
            showError("paymentType", "Please select payment type");
          else clearError("paymentType");

          if (paymentType === "transfer" && !receipt) {
            showError("receipt", "please upload your payment receipt");
          } else {
            clearError("receipt");
          }

          if (!isValid) return;

          const formData = new FormData();
          formData.append("firstname", firstname);
          formData.append("lastname", lastname);
          formData.append("email", email);
          formData.append("phone", phone);
          formData.append("course", course);
          formData.append("class_type", classType);
          formData.append("payment_type", paymentType);
          formData.append("amount", amount);
          if (receipt) formData.append("receipt", receipt);

          try {
            const response = await fetch("http://127.0.0.1:8000/api/purchase", {
              method: "POST",
              body: formData,
            });

            const data = await response.json();

            if (response.ok) {
              let modal = new bootstrap.Modal(
                document.getElementById("exampleModal")
              );
              modal.show();

              form.reset();
              document.getElementById("transfer-info").style.display = "none";
            } else {
              Object.keys(data.errors).forEach((field) => {
                showError(field, data.errors[field][0]);
              });
            }
          } catch (error) {
            alert("Something went wrong, please try again later.");
          }
        });
    </script>
  </body>
</html>
